version: 0.1
android_test_host: amazon_linux_2
phases:
  install:
    commands:
      - echo "Installing Node.js v18.20.0..."
      - curl -O https://nodejs.org/dist/v18.20.0/node-v18.20.0-linux-x64.tar.xz
      - tar -xf node-v18.20.0-linux-x64.tar.xz
      - export PATH=$PWD/node-v18.20.0-linux-x64/bin:$PATH
      - node -v
      - npm -v
      - npm install @wdio/cli@latest @wdio/local-runner @wdio/spec-reporter webdriverio
  pre_test:
    commands:
      - echo Preparing test environment...
  test:
    commands:
      - cd $DEVICEFARM_TEST_PACKAGE_PATH
      - echo "Start Appium Node test"
      - pwd
      - ls -la
      - node_modules/.bin/wdio run wdio.conf.ts
      - echo "Starting the Appium NodeJS test"
  post_test:
    commands:
      - echo Test execution complete.
artifacts:
  - '*/.png'
  - '*/.mp4'
  - '*/.log'
  - '*/results//'
